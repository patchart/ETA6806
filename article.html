<!DOCTYPE html>
<html>
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
		<link rel="icon" href="multimedia/icon.jpg"/>
		<style>
			/* stylisation d'ensemble */
			body, html {
				height: 100%;
				margin: 0;
				background-color: rgb(0, 0, 0);
			}
			a {
				color: rgb(255, 255, 255);
				text-decoration: none;
			}
			a:hover {
				cursor: pointer;
			}
			/* stylisation du DOM */
			.images:not(:first-child) {
				display: none;
			}
			.button {
				border: none;
				background-color: inherit;
				font: 100 75px "Helvetica Neue", Helvetica,Arial, sans-serif;
				color: rgb(255, 255, 255);
			}
			.button:hover {
				cursor: pointer;
			}
			.button:focus {
				outline-color: #205064;
			}
			/* stylisation de l'alternative */
			aside {
				width: 50%;
				margin: auto;
				padding: 15px;
				text-align: center;
				font: 200 18px "Helvetica Neue", Helvetica,Arial, sans-serif;
				color: rgb(255, 255, 255);
			}
			aside ul {
				list-style: none;
				padding-left: 0;
			}
			aside ul li {
				display: inline;
			}
			/* stylisation de l'article */
			article {
				width: 50%;
				margin: 25px auto;
				font: 200 28px "Helvetica Neue", Helvetica,Arial, sans-serif;
				text-align: center;
				color: rgb(255, 255, 255);
			}
			@media screen and (max-width: 450px) {
				article {
					width: 95%;
					font-size: 22px;
				}
			}
			article h1 {
				text-transform: uppercase;
				font: 100 46px "Helvetica Neue", Helvetica,Arial, sans-serif;
				color: rgb(255, 255, 255);
			}
			@media screen and (max-width: 450px) {
				article h1 {
					font-size: 40px;
				}
			}
			article h2 {
				font: 100 28px "Helvetica Neue", Helvetica,Arial, sans-serif;
				color: rgb(255, 255, 255);
			}
			@media screen and (max-width: 450px) {
				article h2 {
					font-size: 22px;
				}
			}
			article p {
				text-align: justify;
			}
			@media screen and (max-width: 450px) {
				article p {
					text-align: left;
				}
			}
			article img {
				width: 100%;
				max-height: 540px;
			}
			article ul {
				list-style: none;
				padding-left: 0;
				text-align: left;
			}
			/* stylisation de la navigation */
			nav {
				width: 50%;
				margin: auto;
				padding: 50px;
				text-align: center;
			}
			nav button {
				width: 170px;
				padding: 10px;
				border: none;
				font: 200 22px "Helvetica Neue", Helvetica,Arial, sans-serif;
				color: rgb(255, 255, 255);
				background-color: rgb(0, 0, 0);
			}
			nav button:last-of-type {
				margin-top: 36px;
				padding: 10px 56px;
			}
			nav button:hover {
				cursor: pointer;
				text-decoration: underline;
			}
			nav button:focus {
				outline-color: none;
			}
		</style>
		<script type="text/javascript" src="https://code.jquery.com/jquery-3.1.1.slim.min.js"></script>
		<script type="text/javascript">
			function page() {
				// on prépare l'identification
				var url, code;
				url = window.location.href;
				code = url.substr(url.length - 8);
				// on envoie la requête XML
				var xhr = new XMLHttpRequest();
				xhr.onload = function() {
					if (xhr.status === 200) {
						var xmlDoc = xhr.responseXML;
						var data = xmlDoc.getElementsByTagName("article");
						var text = xmlDoc.getElementsByTagName("paragraph");
						var multimedia = xmlDoc.getElementsByTagName("photo");
						var article = document.getElementById("article");
						article.innerHTML = "";
						// on calcul le nombre de données
						for (var i = 0; i < data.length; i++) {
							// on fait une condition pour identifier les données
							if (code == data[i].getAttribute("no")) {
								// on récupère les données dans les attributs et les éléments XML
								var title, date, image, graph, metadata, length, climax, viewpoint, duration, paragraph, photo, button;
								title = document.createElement("h1");
								title.appendChild(document.createTextNode(getNodeValue(data[i], "title")));
								article.appendChild(title);
								date = document.createElement("h2");
								date.appendChild(document.createTextNode(getNodeValue(data[i], "date")));
								article.appendChild(date);
								image = document.createElement("img");
								image.setAttribute("src", "multimedia/"+code+"/image.jpg");
								article.appendChild(image);
								graph = document.createElement("img");
								graph.setAttribute("src", "multimedia/"+code+"/graph.jpg");
								article.appendChild(graph);
								metadata = document.createElement("ul");
								article.appendChild(metadata);
								length = document.createElement("li");
								length.innerHTML = "Length: ";
								length.appendChild(document.createTextNode(getNodeValue(data[i], "length")));
								metadata.appendChild(length);
								climax = document.createElement("li");
								climax.innerHTML = "Climax: ";
								climax.appendChild(document.createTextNode(getNodeValue(data[i], "climax")));
								metadata.appendChild(climax);
								viewpoint = document.createElement("li");
								viewpoint.innerHTML = "Viewpoint: ";
								viewpoint.appendChild(document.createTextNode(getNodeValue(data[i], "viewpoint")));
								metadata.appendChild(viewpoint);
								duration = document.createElement("li");
								duration.innerHTML = "Duration: ";
								duration.appendChild(document.createTextNode(getNodeValue(data[i], "duration")));
								metadata.appendChild(duration);
								var x = "", j;
								for (var j = 0; j < text.length; j++) {
  									x += "<p>"+text[j].textContent+"</p>";
								}
								paragraph = document.createElement("div");
								paragraph.innerHTML = x;
								article.appendChild(paragraph);
								var y = "", k;
								for (k = 0; k < multimedia.length; k++) {
  									y += "<img class='images' src='multimedia/"+code+"/photo-"+multimedia[k].getAttribute("status")+".jpg'/>";
								}
								photo = document.createElement("div");
								photo.innerHTML = y;
								article.appendChild(photo);
								button = document.createElement("button");
								button.setAttribute("onclick", "slide(1)");
								button.setAttribute("class", "button");
								button.innerHTML = "&#10227;";
								article.appendChild(button);
							}
						}
						function getNodeValue(obj, tag) {
							return obj.getElementsByTagName(tag)[0].firstChild.nodeValue;
						}
					}
				};
				// on charge le contenu du document
				xhr.open("GET", "document/articles.xml", true);
				xhr.send(null);
			}
		</script>
		<script type="text/javascript">
			var index = 1;
			show(index);
			function slide(n) {
				show(index += n);
			}
			function show(n) {
				var i;
				var x = document.getElementsByClassName("images");
				if (n > x.length) {index = 1}
				if (n < 1) {index = x.length}
				for (i = 0; i < x.length; i++) {
					x[i].style.display = "none";
				}
				x[index-1].style.display = "block";
			}
		</script>
	</head>
	<body onload="page()">
		<aside><ul><li><a href=".">en</a></li><li>&nbsp;&#8212;&nbsp;</li><li><a href="article_fr.html">fr</a></li></aside>
		<article id="article"><!-- Document Object Model Contents --></article>
		<nav><button onClick="location.href='https://ofstoriesandtrees.github.io/index/main.html'">home</button></nav>	
	</body>
</html>
